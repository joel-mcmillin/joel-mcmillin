## CNN with Keras - Applied to Wildfire Images

### _Business Problem_:
### My project is looking at the broad business problem of wildfire detection and prevention. With an average of 70,006 wildfires per year, the government has spent more than $40 billion over the last 40 years to extinguish this wide-reaching threat which burns roughly 5 million acres per year (Bishop). Most of this amount was spent only in the last 20 years (“Insurance Landscapes”). Wildfires destroy homes, businesses and infrastructure, and insurance rates can rise dramatically because of the destruction. With the average cost of $74,409 to put out each wildfire, and average insurance payouts of $224,000 (“Good Neighbor”), insurance companies are pulling their business out of some states due to the difficulty in reducing the level of risk associated with wildfires (Bishop; Fecht). This is especially true in states prone to catastrophic wildfire damage like California, which constitutes more than 20% of acreage destroyed yearly (Bishop). While these statistics all speak to damages already caused and expenses already incurred, another important consideration is the amount of at-risk property around the country and considering cost savings associated with preventing and mitigating wildfire damage. Among the top 10 most at-risk states, there are a total of roughly 4,279,700 at-risk properties (Martin). This means a potential for insurance payouts of over $950 billion, without considering the expense to the government and individuals. 
### _Background History_:
### Over the last few years, wildfires are in the news more regularly as temperatures and dry weather increase around larger areas of the country. I’ve lived in Washington state, which ranks as one of the top 10 most at-risk states with respect to wildfire risk (Martin), so this is a topic that has been top-of-mind. Taking the information shared in the Business Problem portion above into consideration, I want to build a model that effectively predicts whether fire is present or not, and then further training the model by providing additional images to improve accuracy.
### _Data Explanation_:
### The dataset I’m using consists of forest fire pictures – labeled and unlabeled, Test set and Training set. I have also found stock photos of fire and smoke, in different contexts than shown in the original dataset. For example, cigarette smoke pictures, when first run through the predictor showed as No Fire. After adding another smoke photo into the training data, the predictor was then able to correctly predict other smoke photos that had not registered as Fire previously. This showed me that the data I was using had the opportunity to predict fire more accurately in more ambiguous photos. By the time I finished this project though, multiple iterations of running this code came up with different results – inconsistently recognizing pictures of just smoke as being Fire Detected vs. No Fire Detected. This presents an opportunity for further research into this throughout the remainder of this course as I clean up various projects for my portfolio.
### The images I used, and the method I chose, a Convolutional Neural Network (CNN), meant the data did not require any cleaning as would be needed with a CSV or similar source.
### _Methods_:
### To model the image data, I used a CNN. A CNN is essentially an artificial neural network made of stacks of convolutional and max-pooling layers. The convolutional layers have a series of filters, and the max-pooling layers are used to downsample the features. By downsampling, we reduce the number of feature-map coefficients being processed, which helps avoid overfitting from having layers with too many parameters (Chollet 127-128). CNNs are also designed to avoid overfitting of the layers themselves (“Convolutional Neural Network”). The CNN takes the image data (Fire and No Fire) to train the model. After training the model, I created a function to predict whether new images introduced showed fire or not.  
### _Analysis_:
### Using Keras, I created the model before compiling it and setting the accuracy metrics. I then ran it for 5 epochs, which gave a best accuracy score of 96.24%. I then re-ran it for 10 epochs, getting an accuracy score of 98%. Part of analyzing the accuracy of my model was also by inspecting functionality of the image prediction function. I started to introduce stock images, which the function predicted correctly (“Fire Detected” or “No Fire Detected”) until I introduced an image of what looks like wisps of cigarette smoke. The image was incorrectly predicted as “No Fire Detected”. I revisited the images used to train the model, and I added the photo showing the cigarette smoke. I then re-ran the entire model from scratch, after which I used the prediction function on similar, but not identical, images to see whether the model could not correctly predict similar images as “Fire Detected”. This was important because a fire in early stages will likely appear as nothing more than smoke. However, upon running the model more times, as noted above, I came across inconsistent results with respect to how the smoke images were labeled. 
### _Conclusion_:
### I have created a model that takes images and effectively determines whether there is a fire or not in the image. This is not a complicated process, as working with CNNs and this type of data is straightforward. The biggest concern I had going into the project, and which continues to be a challenge, is how well the predictive function works with new images. I initially found the model was well-enough trained, and could be updated with new training information, sufficiently to retain predictive value. As already mentioned though, further work with the model showed limited predictive ability. The accuracy scores were high – 97-98%, but there appears to be over-fitting issues as the model inconsistently labels images of smoke. 
### _Assumptions, Limitations and Challenges_:
### This model does rely on the assumption that there isn’t any over-fitting. The CNN’s setup should limit that concern, but it can be difficult to know whether there is an issue until one arises, as seen earlier. This is reflected in having various images that are predicted incorrectly. This would then also be a limitation and an unanticipated challenge, due to how well the model currently works. One thing I noticed in adding new images was that adding a generic smoke photo, previously mentioned, didn’t register as “Fire,” but a similar image, where the smoke was red, did register as “Fire”. This makes me wonder how heavily the color of the image is weighted in the model, and I haven’t been able to find a way to verify whether this is a legitimate potential issue or not. This is something I will continue to investigate.
### _Future Uses & Additional Applications_:
### Ideally, this model could be used with a series of cameras strategically placed in areas prone to wildfires. Another options would be using drones with cameras. The camera would take photos at regular intervals to then be run through the predictive function. If a fire is recognized, then fire departments, homeowners, businesses, etc., would be alerted to act and address the fire immediately. Similarly, a system could be set up that would automatically put out fires as soon as they’re detected (drone deployment?). Recognizing that early detection could help prevent large fires, especially in more geographically isolated areas (Chiu), a system like this using a network of cameras in conjunction with this model has the potential to save millions of dollars plus. 
### _Recommendations, Implementation Plan and Other Considerations_:
### One consideration prior to implementation is that the model needs to predict with greater accuracy the presence of fire more consistently in images of smoke without visible fire. My main recommendation to stakeholders and interested parties is to investigate how this system could be implemented once the smoke image concern is resolved. How would the network of cameras be funded, installed, and maintained? On the surface, the plan seems simple, but even knowing where to place cameras could be tricky due to land ownership. Whether the proposed locations are privately or publicly owned could affect coverage for the network to the detriment of the system. If a high-risk area cannot get coverage due to access restrictions, then a fire could potentially already be advanced enough that by the time it’s caught by a camera that does have access. Otherwise, access restrictions aside, implementation should be as simple as placing the cameras in strategic locations of various elevations to ensure sufficient coverage so that incoming images can be analyzed for the presence of fire. 
### _Ethical Assessment_:
### The main ethical concern that needs to be considered is anonymization of data if any personal information were to be recorded. For example, there may be some limitations with how data is used if it contains a person’s likeness, their license plate information, etc. The system would need to be updated in such a way that images could be cleaned of that personal data prior to it being saved and used in any way. However, there’s the possibility that this isn’t necessary in the same way that businesses can install security cameras, using those images without blurring personal details. It’s also important that any possible bias be removed. For this project, that could look as simple as ensuring network coverage for all areas equally, so that lower income urban or rural areas would be given the same benefit as in higher income areas. As I finish this project, the biggest concern I’m left with is that the model is inconsistent in its ability to accurately predict photos that just show smoke, without any visible fire present. It would be unethical to hide results like this because it would inaccurately paint the model as more effective than it is, potentially at the cost of billions of dollars. 
***
### References:
* Bishop, Lindsay. “Wildfire Statistics: Damage, Fatalities and Insurance Rates.” Value Penguin, 7 July 2023, www.valuepenguin.com/homeowners-insurance/wildfire-statistics#:~:text=On%20average%2C%20wildfires%20burn%205,billion%20fighting%20wildfires%20in%202021.
* Chiu, Allyson. “How Sensors Could Help Catch Wildfires before They Spread.” The Washington Post, 16 June 2023, www.washingtonpost.com/climate-solutions/2023/06/15/wildfire-early-detection-sensors-technology/.
* Chollet, Francois. Deep Learning with Python. Manning Publications Co., 2018.
* “Convolutional Neural Network.” Wikipedia, 12 July 2023, en.wikipedia.org/wiki/Convolutional_neural_network.
* Dincer, Baris. “Wildfire Detection Image Data.” Kaggle, www.kaggle.com/datasets/brsdincer/wildfire-detection-image-data. Accessed 3 July 2023.
* Fecht, Sarah, et al. “State Farm’s California Pullout: What It Means for Climate Adaptation and Communities.” State of the Planet, 16 June 2023, news.climate.columbia.edu/2023/06/07/state-farms-california-pullout-what-it-means-for-climate-adaptation-and-communities/.
* “Good Neighbor.” Wildfire Claims Average $224k, 3 May 2022, newsroom.statefarm.com/wildfire-claims/.
* “Insurance Landscape Hardens Further as Wildfires Rage.” CRC Group, www.crcgroup.com/Tools-Intel/post/insurance-landscape-hardens-further-as-wildfires-rage#:~:text=From%201964%20to%201990%2C%20the,almost%20%244%20billion%20a%20year. Accessed 18 July 2023.
* Martin, Shannon. “2023 U.S. Wildfire Statistics.” Bankrate, www.bankrate.com/insurance/homeowners-insurance/wildfire-statistics/#wildfire-statistics-by-state. Accessed 14 July 2023.
* “Wildfires.” Congressional Budget Office, www.cbo.gov/publication/58212#:~:text=One%20study%20estimated%20that%20the,(in%202020%20dollars)%20nationally. Accessed 19 July 2023. 
